Search.setIndex({"docnames": ["changes", "index", "m3gnet", "m3gnet.callbacks", "m3gnet.cli", "m3gnet.config", "m3gnet.graph", "m3gnet.layers", "m3gnet.models", "m3gnet.trainers", "m3gnet.type", "m3gnet.utils", "m3gnet.utils.constants", "modules"], "filenames": ["changes.md", "index.md", "m3gnet.rst", "m3gnet.callbacks.rst", "m3gnet.cli.rst", "m3gnet.config.rst", "m3gnet.graph.rst", "m3gnet.layers.rst", "m3gnet.models.rst", "m3gnet.trainers.rst", "m3gnet.type.rst", "m3gnet.utils.rst", "m3gnet.utils.constants.rst", "modules.rst"], "titles": ["Changelog", "M3GNet", "m3gnet package", "m3gnet.callbacks module", "m3gnet.cli module", "m3gnet.config module", "m3gnet.graph package", "m3gnet.layers package", "m3gnet.models package", "m3gnet.trainers package", "m3gnet.type module", "m3gnet.utils package", "m3gnet.utils.constants module", "m3gnet"], "terms": {"simpl": [0, 1, 7, 11], "cli": [0, 2, 13], "tool": 0, "relax": [0, 8], "crystal": [0, 1], "less": [0, 1], "noisi": 0, "default": [0, 1, 6, 8], "fix": [0, 1, 6], "model": [0, 2, 9, 13], "download": [0, 1], "more": [0, 1], "document": [0, 1], "bug": 0, "edg": [0, 6, 7], "case": [0, 1], "tripl": [0, 6], "bond": [0, 6, 7, 11], "enabl": 0, "weight": [0, 7, 8, 11], "within": [0, 1, 6], "code": [0, 3], "initi": [0, 1, 7], "releas": 0, "new": [1, 6, 7, 8], "materi": [1, 6, 8, 9], "graph": [1, 2, 7, 8, 9, 11, 13], "neural": [1, 9], "network": [1, 7, 9], "architectur": 1, "incorpor": 1, "3": [1, 6, 8, 11], "bodi": [1, 7], "interact": [1, 7], "A": [1, 7], "kei": 1, "differ": [1, 11], "prior": 1, "implement": [1, 7, 11], "megnet": 1, "addit": 1, "coordin": 1, "atom": [1, 6, 7, 8, 11], "lattic": [1, 6, 7], "matrix": [1, 11], "which": [1, 8], "ar": [1, 6, 7], "necessari": 1, "obtain": [1, 6], "tensori": 1, "quantiti": 1, "forc": [1, 6, 8, 9], "stress": [1, 6, 8, 9], "via": [1, 7], "auto": 1, "differenti": 1, "As": 1, "framework": [1, 2], "ha": [1, 6, 11], "divers": 1, "applic": 1, "includ": [1, 7, 8], "interatom": 1, "potenti": [1, 8, 9], "develop": 1, "With": 1, "same": 1, "data": [1, 5, 6, 9, 11], "perform": [1, 7], "similarli": 1, "state": [1, 6, 7, 11], "art": 1, "machin": 1, "learn": 1, "ml": 1, "iap": 1, "howev": 1, "featur": [1, 6, 7], "represent": [1, 6, 7], "its": 1, "flexibl": 1, "scale": 1, "chemic": 1, "space": [1, 7], "One": 1, "accomplish": 1, "univers": 1, "can": [1, 8], "work": 1, "across": 1, "entir": 1, "period": [1, 6, 7], "element": [1, 7, 8, 9], "project": 1, "surrog": 1, "properti": [1, 6, 7, 8, 9], "predict": [1, 7, 8, 9], "like": 1, "previou": [1, 8, 9], "us": [1, 5, 6, 7, 10, 11], "achiev": 1, "mani": [1, 6], "accuraci": 1, "better": 1, "similar": [1, 7], "other": [1, 11], "For": [1, 7, 11], "detail": 1, "benchmark": 1, "pleas": 1, "public": 1, "section": 1, "The": [1, 2, 6, 7, 8, 11], "avail": [1, 6], "github": 1, "page": 1, "infer": 1, "pre": [1, 8, 11], "ran": 1, "ani": [1, 11], "standard": 1, "comput": [1, 6, 7, 8, 11], "gpu": 1, "memori": 1, "need": [1, 6], "18": 1, "gb": 1, "batch": [1, 3, 6, 8, 9], "size": [1, 8, 9, 11], "32": [1, 5, 9], "In": [1, 6], "our": 1, "we": [1, 11], "singl": [1, 6], "rtx": 1, "3090": 1, "pip": 1, "you": 1, "also": [1, 7], "directli": 1, "sourc": 1, "from": [1, 4, 6, 7, 8, 9, 11], "m1": 1, "pro": 1, "max": [1, 8, 11], "ultra": 1, "extrem": 1, "power": 1, "capabl": 1, "special": 1, "step": [1, 7, 8], "tensorflow": [1, 5, 6, 11], "depend": 1, "here": [1, 8, 11], "recommend": 1, "ensur": [1, 11], "alreadi": 1, "have": 1, "xcode": 1, "miniconda": 1, "anaconda": 1, "creat": 1, "python": 1, "9": [1, 6], "environ": 1, "conda": 1, "name": [1, 6, 8, 9, 11], "activ": [1, 7], "first": [1, 11], "c": 1, "dep": 1, "maco": 1, "If": [1, 8, 9, 11], "wish": 1, "metal": 1, "help": 1, "speed": 1, "up": [1, 7], "encount": 1, "strang": 1, "error": [1, 11], "should": [1, 8], "uninstal": 1, "see": 1, "ignor": 1, "otherwis": 1, "look": 1, "pymatgen": [1, 6, 8], "etc": [1, 6, 7, 9], "manual": [1, 3], "protobuf": 1, "20": [1, 7, 11], "0": [1, 6, 7, 8, 9, 11], "ase": [1, 8], "cython": 1, "onc": 1, "done": 1, "try": 1, "run": [1, 7, 8], "pytest": 1, "all": [1, 6], "test": 1, "pass": 1, "been": 1, "sinc": [1, 11], "2012": 1, "thi": [1, 6, 7, 8, 11], "arbitrari": 1, "follow": [1, 6, 7, 8], "core": 1, "import": 1, "init": 1, "mo": 1, "stretch": 1, "dft": 1, "constant": 1, "168": 1, "cubic": 1, "5": [1, 6, 11], "load": [1, 8], "relax_result": 1, "final_structur": 1, "final_energi": 1, "trajectori": [1, 8], "energi": [1, 6, 7, 8, 9], "1": [1, 6, 8, 9, 11], "2": [1, 6, 7, 8, 11], "print": 1, "f": 1, "paramet": [1, 4], "abc": [1, 8], "3f": 1, "\u00e5": 1, "final": 1, "item": [1, 11], "ev": 1, "output": [1, 7, 8], "169": 1, "10": [1, 6, 7, 9, 11], "859": 1, "wa": [1, 11], "successfulli": 1, "close": 1, "valu": [1, 6, 7, 8, 11], "8456": 1, "take": [1, 7, 11], "than": 1, "second": [1, 11], "laptop": 1, "below": 1, "provid": 1, "comprehens": 1, "base": [1, 3, 5, 6, 7, 8, 9, 11], "exp": 1, "wikipedia": 1, "mp": [1, 8], "jupyt": 1, "notebook": 1, "exampl": [1, 7, 11], "folder": 1, "limit": 1, "eas": 1, "comparison": 1, "onli": 1, "one": [1, 6], "cours": 1, "lifepo4": 1, "vs": 1, "expt": 1, "ac": 1, "fcc": 1, "31": 1, "66226": 1, "6646": 1, "6": [1, 6, 8], "68": 1, "04": 1, "ag": 1, "4": [1, 6, 11], "079": 1, "16055": 1, "16702": 1, "16": [1, 5, 6], "al": 1, "046": 1, "03893": 1, "04108": 1, "12": [1, 6], "05": 1, "ala": 1, "zinc": 1, "blend": 1, "6605": 1, "73376": 1, "73027": 1, "23": 1, "06": 1, "alp": 1, "451": 1, "50711": 1, "50346": 1, "96": 1, "07": [1, 8], "alsb": 1, "1355": 1, "23376": 1, "22817": 1, "51": 1, "09": 1, "26": 1, "64077": 1, "62745": 1, "99": 1, "24": 1, "au": 1, "065": 1, "17129": 1, "17431": 1, "69": 1, "bn": 1, "615": 1, "626": 1, "62485": 1, "27": 1, "03": 1, "bp": 1, "538": 1, "54682": 1, "54711": 1, "01": [1, 8], "ba": 1, "bcc": 1, "02": 1, "0303": 1, "03454": 1, "29": 1, "08": [1, 6], "diamond": 1, "567": 1, "57371": 1, "5718": 1, "13": [1, 6], "ca": 1, "58": 1, "50737": 1, "52597": 1, "97": 1, "34": 1, "cavo3": 1, "perovskit": 1, "767": 1, "83041": 1, "83451": 1, "79": 1, "11": [1, 6], "cd": 1, "832": 1, "94083": 1, "9419": 1, "88": 1, "cdse": 1, "21283": 1, "20987": 1, "64": 1, "cdte": 1, "482": 1, "62905": 1, "62619": 1, "22": 1, "ce": 1, "72044": 1, "71921": 1, "8": [1, 6, 8], "54": 1, "cr": 1, "87403": 1, "84993": 1, "84": 1, "crn": 1, "halit": 1, "149": 1, "16068": 1, "28": 1, "cs": 1, "11004": 1, "27123": 1, "87": 1, "73": 1, "cscl": 1, "caesium": 1, "chlorid": 1, "123": 1, "20906": 1, "20308": 1, "94": 1, "14": [1, 6], "csf": 1, "11801": 1, "1265": 1, "77": 1, "csi": 1, "66521": 1, "90767": 1, "7": [1, 6], "46": 1, "cu": 1, "597": 1, "62126": 1, "61199": 1, "42": 1, "eu": 1, "61": 1, "63903": 1, "34783": 1, "eutio3": 1, "81": 1, "96119": 1, "92943": 1, "49": 1, "80": 1, "fe": 1, "856": 1, "84005": 1, "85237": 1, "43": 1, "gaa": 1, "653": 1, "75018": 1, "75055": 1, "gap": 1, "4505": 1, "5063": 1, "5054": 1, "gasb": 1, "0959": 1, "21906": 1, "21939": 1, "ge": 1, "658": 1, "76286": 1, "7698": 1, "98": 1, "hfc0": 1, "65131": 1, "65023": 1, "hfn": 1, "392": 1, "53774": 1, "53838": 1, "33": 1, "ina": 1, "0583": 1, "18148": 1, "25374": 1, "17": 1, "inp": 1, "869": 1, "95673": 1, "9679": 1, "19": 1, "insb": 1, "479": 1, "63322": 1, "63863": 1, "ir": 1, "87573": 1, "87716": 1, "k": 1, "26212": 1, "4993": 1, "15": [1, 6], "kbr": 1, "70308": 1, "70797": 1, "kcl": 1, "38359": 1, "39634": 1, "kf": 1, "42398": 1, "41971": 1, "ki": 1, "18534": 1, "18309": 1, "60": 1, "ktao3": 1, "9885": 1, "03084": 1, "03265": 1, "kr": 1, "72": 1, "49646": 1, "25924": 1, "65": 1, "li": 1, "42682": 1, "41891": 1, "libr": 1, "51343": 1, "51076": 1, "licl": 1, "15275": 1, "14745": 1, "lif": 1, "08343": 1, "08531": 1, "37": 1, "lii": 1, "0257": 1, "02709": 1, "mgo": 1, "212": 1, "25648": 1, "2567": 1, "142": 1, "16762": 1, "16937": 1, "na": [1, 8, 11], "17262": 1, "19684": 1, "78": 1, "nabr": 1, "0276": 1, "01922": 1, "82": 1, "nacl": 1, "69169": 1, "69497": 1, "naf": 1, "63": 1, "69625": 1, "69553": 1, "nai": 1, "47": 1, "532": 1, "52739": 1, "89": 1, "nb": [1, 11], "3008": 1, "32052": 1, "32221": 1, "nbn": 1, "45247": 1, "45474": 1, "ne": 1, "30383": 1, "95744": 1, "57": 1, "66": 1, "ni": 1, "499": 1, "5058": 1, "5086": 1, "pb": 1, "92": 1, "05053": 1, "02849": 1, "21": 1, "44": 1, "9362": 1, "00645": 1, "01752": 1, "pbte": 1, "462": 1, "56567": 1, "56111": 1, "53": 1, "pd": 1, "95707": 1, "95466": 1, "48": 1, "pt": 1, "912": 1, "97677": 1, "97714": 1, "67": 1, "rb": 1, "59": 1, "64416": 1, "63235": 1, "76": 1, "rbbr": 1, "02793": 1, "98219": 1, "rbcl": 1, "69873": 1, "67994": 1, "36": 1, "rbf": [1, 7], "73892": 1, "76843": 1, "rbi": 1, "35": 1, "48785": 1, "61756": 1, "rh": 1, "8439": 1, "84935": 1, "30": [1, 11], "scn": 1, "52": 1, "51831": 1, "51797": 1, "si": 1, "43102": 1, "46873": 1, "45002": 1, "sr": 1, "02253": 1, "04449": 1, "srtio3": 1, "98805": 1, "94513": 1, "94481": 1, "srvo3": 1, "838": 1, "90089": 1, "90604": 1, "ta": 1, "3058": 1, "32229": 1, "31741": 1, "tac0": 1, "456": 1, "48208": 1, "48225": 1, "00": 1, "th": [1, 7, 11], "04122": 1, "04483": 1, "tic": 1, "328": 1, "33565": 1, "33493": 1, "tin": 1, "249": 1, "25353": 1, "25254": 1, "v": [1, 7], "0399": 1, "99254": 1, "99346": 1, "vc0": 1, "166": 1, "16195": 1, "16476": 1, "vn": 1, "136": 1, "12493": 1, "1281": 1, "w": 1, "155": 1, "18741": 1, "18826": 1, "xe": 1, "66148": 1, "06991": 1, "yb": 1, "44925": 1, "45807": 1, "zno": 1, "33888": 1, "33424": 1, "zn": 1, "45027": 1, "45297": 1, "zrc0": 1, "698": 1, "72434": 1, "72451": 1, "56": 1, "zrn": 1, "577": 1, "61762": 1, "61602": 1, "85": 1, "observ": 1, "almost": 1, "major": 1, "iodid": 1, "nobl": 1, "gase": 1, "It": [1, 7], "quit": 1, "wrong": 1, "factor": 1, "lower": [1, 7], "expect": 1, "mai": [1, 6, 11], "due": 1, "pauciti": 1, "note": 1, "reproduc": 1, "experiment": 1, "an": [1, 6, 7, 9, 11], "point": [1, 9], "1s": 1, "mac": 1, "written": 1, "right": 1, "now": 1, "support": 1, "just": 1, "do": [1, 11], "immedi": 1, "quick": 1, "itself": 1, "futur": 1, "user": 1, "interest": 1, "m3g": 1, "infil": 1, "li2o": 1, "cif": 1, "stdout": 1, "outfil": 1, "li2o_relax": 1, "file": [1, 3, 8], "md": [1, 8], "simul": 1, "well": 1, "moleculardynam": [1, 8], "temperatur": [1, 8], "1000": [1, 9], "ensembl": [1, 8], "nvt": [1, 8], "timestep": [1, 8], "1f": 1, "traj": 1, "save": [1, 8, 9], "logfil": [1, 8], "loginterv": [1, 8], "100": 1, "interv": [1, 8], "record": 1, "after": [1, 11], "contain": [1, 11], "thermodynam": 1, "inform": [1, 7], "time": [1, 11], "ps": 1, "etot": 1, "epot": 1, "ekin": 1, "t": [1, 11], "0000": 1, "3307": 1, "2000": 1, "2441": 1, "3087": 1, "0645": 1, "3000": 1, "0466": 1, "2358": 1, "1891": 1, "731": 1, "4000": 1, "9702": 1, "1149": 1, "1447": 1, "559": 1, "5000": 1, "9380": 1, "1093": 1, "1713": 1, "662": 1, "6000": 1, "9176": 1, "1376": 1, "2200": 1, "850": 1, "7000": 1, "9016": 1, "1789": 1, "2773": 1, "1072": 1, "8000": 1, "8804": 1, "1638": 1, "2835": 1, "1096": 1, "9000": 1, "8770": 1, "0695": 1, "1925": 1, "744": 1, "8908": 1, "0772": 1, "1864": 1, "721": 1, "minut": 1, "your": 1, "own": 1, "potentialtrain": [1, 9], "trainer": [1, 2, 13], "list": [1, 6, 7, 8, 9, 11], "float": [1, 6, 7, 8, 9, 11], "unit": 1, "nx3": 1, "where": [1, 7], "n": [1, 11], "number": [1, 6, 7, 8, 11], "each": [1, 6, 7, 11], "doe": [1, 7, 11], "3x3": 1, "matric": [1, 6], "gpa": 1, "option": [1, 3, 6, 8, 9, 11], "convent": 1, "compress": 1, "give": [1, 11], "neg": 1, "vasp": 1, "calcul": [1, 6, 7, 8, 11], "kbar": 1, "multipli": 1, "valid": [1, 9], "select": 1, "stop": [1, 3, 9], "epoch": [1, 3, 6, 9], "format": [1, 6, 7], "minim": 1, "shown": 1, "tf": [1, 6, 7, 8, 9, 11], "is_intens": 1, "fals": [1, 8, 9, 11], "optim": [1, 8, 9], "kera": [1, 9], "adam": 1, "1e": [1, 6], "validation_graphs_or_structur": [1, 9], "val_structur": 1, "val_energi": [1, 9], "val_forc": [1, 9], "val_stress": [1, 9], "fit_per_element_offset": [1, 9], "true": [1, 6, 8, 9, 11], "save_checkpoint": [1, 9], "discoveri": 1, "databas": 1, "yet": 1, "sythes": 1, "call": [1, 3, 7, 8], "ai": 1, "At": 1, "write": 1, "million": 1, "stabl": 1, "candid": 1, "gener": [1, 6], "combinatori": 1, "isoval": 1, "ionic": 1, "substitut": 1, "common": 1, "oxid": 1, "non": 1, "ga": 1, "283": 1, "binari": 1, "ternari": 1, "quaternari": 1, "prototyp": 1, "2019": 1, "version": 1, "icsd": 1, "mpf": 1, "2021": [1, 8], "host": 1, "figshar": 1, "doi": 1, "6084": 1, "m9": 1, "19470599": 1, "cite": 1, "chi": 1, "chen": 1, "shyue": 1, "ping": 1, "ong": 1, "deep": 1, "arxiv": [1, 11], "preprint": 1, "2202": 1, "02450": 1, "http": [1, 11], "org": [1, 11], "ab": 1, "2022": 1, "primarili": 1, "fund": 1, "u": [1, 7], "s": 1, "depart": 1, "offic": 1, "scienc": 1, "basic": [1, 6], "engin": 1, "divis": 1, "under": 1, "contract": 1, "de": 1, "ac02": 1, "ch11231": 1, "program": 1, "kc23mp": 1, "expans": [1, 7, 11], "supercomput": 1, "cluster": 1, "xsede": 1, "nation": 1, "foundat": 1, "grant": 1, "aci": 1, "1548562": 1, "layer": [2, 6, 8, 13], "util": [2, 13], "callback": [2, 9, 13], "config": [2, 7, 8, 13], "type": [2, 5, 6, 9, 13], "function": [3, 5, 7, 8, 9, 11], "class": [3, 5, 6, 7, 8, 9, 11], "manualstop": 3, "train": [3, 6, 8, 9], "put": 3, "directori": [3, 8, 9], "on_batch_end": 3, "int": [3, 6, 8, 9, 11], "log": 3, "dict": [3, 6, 7, 8], "none": [3, 5, 6, 8, 9, 11], "end": [3, 6, 11], "arg": [3, 4, 5, 6, 7, 8, 9, 11], "id": [3, 11], "return": [3, 5, 6, 7, 8, 9, 11], "main": [4, 7, 8], "handl": [4, 8], "relax_structur": 4, "view": 4, "command": 4, "datatyp": 5, "object": [5, 6, 7, 8, 9, 11], "numpi": 5, "choos": 5, "between": 5, "float16": 5, "float32": 5, "np_float": 5, "np_int": 5, "int32": 5, "classmethod": [5, 6, 7, 8], "set_dtyp": 5, "data_typ": 5, "str": [5, 6, 8, 9], "method": [5, 8], "set": [5, 6, 7, 8], "tf_float": 5, "tf_int": 5, "set_global_dtyp": 5, "basegraphconvert": 6, "kwarg": [6, 7, 8, 11], "convert": [6, 7], "node": 6, "abstract": [6, 8], "structur": [6, 7, 8, 9], "union": [6, 8, 11], "molecul": [6, 8], "materialgraph": [6, 7, 8, 9], "convert_mani": 6, "static": [6, 11], "get_atom_featur": 6, "ndarrai": [6, 7, 8, 11], "get": [6, 7, 8, 11], "overwritten": 6, "get_stat": 6, "attribut": [6, 7, 11], "structureormolecul": [6, 8], "tensor": [6, 7, 8, 11], "np": [6, 7, 8, 11], "set_default_st": 6, "index": [6, 11], "integ": [6, 11], "indic": [6, 7, 11], "field": [6, 7, 9, 11], "atom_posit": 6, "bond_atom_indic": 6, "bond_weight": 6, "n_atom": 6, "n_bond": 6, "n_triple_i": 6, "n_triple_ij": 6, "n_triple_": 6, "pbc_offset": 6, "phi": [6, 11], "theta": 6, "triple_bond_indic": 6, "triple_bond_length": 6, "attributeupdatemixin": 6, "pad": 6, "full": 6, "assum": 6, "n_struct": 6, "shape": [6, 11], "pair": [6, 7, 11], "arrai": [6, 7, 11], "posit": [6, 7, 8], "length": 6, "boundari": [6, 11], "offset": [6, 7, 9], "vector": [6, 7], "form": 6, "azimuth": 6, "angl": [6, 7], "polar": 6, "as_list": 6, "as_tf": 6, "base_attribut": 6, "classvar": 6, "copi": [6, 7], "from_list": 6, "graph_list": [6, 8], "construct": [6, 7, 8], "instanc": [6, 8, 11], "graph_with_position_attribut": 6, "has_threebodi": 6, "bool": [6, 8, 9, 11], "whether": [6, 8, 9, 11], "threebodi": 6, "boolean": 6, "three_body_attribut": 6, "materialgraphbatch": 6, "target": [6, 9], "batch_siz": [6, 8, 9], "128": [6, 8, 9, 11], "shuffl": 6, "sequenc": [6, 7, 11], "on_epoch_end": 6, "oper": 6, "materialgraphbatchenergyforcestress": 6, "radiuscutoffgraphconvert": 6, "radiu": [6, 7, 11], "cutoff": [6, 7, 11], "get_config": [6, 7, 8], "serial": [6, 7, 8], "dictionari": [6, 7, 8], "assemble_material_graph": 6, "collat": 6, "get_fixed_radius_bond": 6, "numerical_tol": 6, "tupl": [6, 8], "numer": 6, "toler": [6, 8, 11], "center_indic": 6, "neighbor_indic": 6, "imag": 6, "distanc": [6, 7, 11], "get_pair_vector_from_graph": 6, "given": [6, 8], "include_threebody_indic": 6, "threebody_cutoff": 6, "without": 6, "add": [6, 7, 8], "accord": [6, 11], "ad": 6, "tf_compute_distance_angl": 6, "triplet": 6, "atomnetwork": 7, "graphupd": 7, "input": 7, "repr": [7, 8], "update_atom": 7, "updat": 7, "atomreducest": 7, "reduc": 7, "sum": [7, 8, 9], "mean": 7, "logic": 7, "configur": 7, "atomref": 7, "baseatomref": 7, "refer": [7, 8], "averag": 7, "h": 7, "o": 7, "50": 7, "h2o": 7, "fit": 7, "structs_or_graph": 7, "extens": [7, 8], "inverse_transform": 7, "transform": 7, "origin": [7, 11], "correct": 7, "predict_properti": 7, "set_property_per_el": 7, "property_per_el": 7, "per": 7, "i": [7, 11], "row": 7, "subtract": 7, "bondnetwork": 7, "update_bond": 7, "info": 7, "concatatom": 7, "eij": 7, "prime": 7, "vi": 7, "vj": 7, "concatbondatomst": 7, "statenetwork": 7, "bar": 7, "e": [7, 9, 11], "update_st": 7, "embed": 7, "thin": [7, 8], "wrapper": [7, 8], "gatedatomupd": 7, "neighbor": 7, "them": 7, "center": [7, 11], "gatedmlp": 7, "gate": 7, "mlp": 7, "out": 7, "x": [7, 11], "mlp_": 7, "sigmoid": 7, "latter": 7, "chang": [7, 8], "last": 7, "graphfeatur": 7, "graphnetworklay": 7, "sever": [7, 10], "thing": 7, "proper": 7, "dimens": [7, 11], "graphfieldembed": 7, "graphupdatefunc": 7, "categor": 7, "continu": [7, 9], "multi": 7, "perceptron": 7, "multifieldreadout": 7, "readout": 7, "read": 7, "both": 7, "pairdist": 7, "pairradialbasisexpans": 7, "expand": [7, 11], "radial": 7, "onto": 7, "basi": [7, 11], "On": [7, 11], "top": 7, "later": 7, "pairvector": 7, "pipe": 7, "consecut": 7, "sequenti": 7, "through": 7, "from_config": [7, 8], "radialbasisfunct": 7, "distribut": 7, "r": [7, 11], "1d": 7, "reducereadout": 7, "dimension": [7, 11], "could": 7, "set2set": 7, "sphericalbesselwithharmon": 7, "spheric": [7, 11], "bessel": [7, 11], "harmon": [7, 11], "angular": 7, "combin": [7, 9, 11], "threedinteract": 7, "3d": 7, "three_basi": 7, "three_cutoff": 7, "three": 7, "weightedreadout": 7, "learnabl": 7, "cosin": 7, "polynomi": 7, "pretrain": 8, "basepotenti": 8, "include_forc": 8, "include_stress": 8, "appli": 8, "get_ef": 8, "obj": 8, "get_ef_tensor": 8, "get_efs_tensor": 8, "get_energi": 8, "ns": [8, 11], "get_forc": 8, "get_stress": 8, "graphmodelmixin": 8, "predict_structur": 8, "predict_graph": 8, "either": 8, "from_dir": 8, "dirnam": [8, 9], "custom_object": 8, "custom": [8, 11], "model_nam": 8, "ef": 8, "path": 8, "set_element_ref": 8, "element_ref": 8, "m3gnetcalcul": 8, "compute_stress": 8, "stress_weight": 8, "system_chang": 8, "monitor": [8, 9], "were": 8, "result": [8, 11], "implemented_properti": 8, "free_energi": 8, "300": 8, "pressur": 8, "324209121801212e": 8, "taut": 8, "taup": 8, "compressibility_au": 8, "append_trajectori": 8, "molecular": 8, "dynam": 8, "set_atom": 8, "defin": [8, 10], "subclass": 8, "fire": 8, "relax_cel": 8, "fmax": 8, "500": 8, "traj_fil": 8, "verbos": [8, 9], "total": 8, "converg": 8, "optimizerv2": 9, "graphs_or_structur": 9, "loss": 9, "mean_squared_error": 9, "force_loss_ratio": 9, "stress_loss_ratio": 9, "early_stop_pati": 9, "200": 9, "val": 9, "ratio": 9, "train_metr": 9, "metric": 9, "val_metr": 9, "val_monitor": 9, "dure": 9, "g": 9, "val_ma": 9, "val_acc": 9, "val_auc": 9, "check": [9, 11], "patienc": 9, "earli": 9, "show": 9, "progress": 9, "wise": 9, "restart_from_directori": 9, "validation_target": 9, "clip_norm": 9, "gradient": 9, "norm": [9, 11], "clip": 9, "conveni": 10, "gaussian": 11, "width": 11, "sphericalbesselfunct": 11, "max_l": 11, "max_n": 11, "smooth": 11, "sympi": 11, "rbf_j0": 11, "order": 11, "vanish": 11, "sphericalharmonicsfunct": 11, "use_phi": 11, "broadcast_states_to_atom": 11, "broadcast": 11, "nstate": 11, "broadcast_states_to_bond": 11, "check_array_equ": 11, "array1": 11, "array2": 11, "rtol": 11, "001": 11, "equal": 11, "two": 11, "narrai": 11, "rel": 11, "check_shape_consist": 11, "compli": 11, "match": 11, "40": 11, "combine_sbf_shf": 11, "sbf": 11, "shf": 11, "column": 11, "block": 11, "m": 11, "l": 11, "becom": 11, "get_length": 11, "equival": 11, "linalg": 11, "axi": 11, "faster": 11, "get_range_indices_from_n": 11, "rang": 11, "get_segment_indices_from_n": 11, "segment": 11, "get_spherical_bessel_root": 11, "precomput": 11, "root": 11, "2d": 11, "entri": 11, "regist": 11, "cl": 11, "register_plain": 11, "class_nam": 11, "repeat_with_n": 11, "repeat": 11, "augment": 11, "specifi": 11, "reshape_arrai": 11, "reshap": 11, "report": 11, "spherical_bessel_root": 11, "fact": 11, "j_l": 11, "z_": 11, "j": 11, "hand": 11, "know": 11, "precis": 11, "j0": 11, "spherical_bessel_smooth": 11, "orthogon": 11, "deriv": 11, "zero": 11, "ref": 11, "pdf": 11, "1907": 11, "02374": 11, "unsorted_segment_fract": 11, "segment_id": 11, "num_seg": 11, "softmax": 11, "unsorted_segment_softmax": 11, "unsort": 11, "packag": 13, "subpackag": 13, "modul": 13, "content": 13, "submodul": 13}, "objects": {"": [[2, 0, 0, "-", "m3gnet"]], "m3gnet": [[3, 0, 0, "-", "callbacks"], [4, 0, 0, "-", "cli"], [5, 0, 0, "-", "config"], [6, 0, 0, "-", "graph"], [7, 0, 0, "-", "layers"], [8, 0, 0, "-", "models"], [9, 0, 0, "-", "trainers"], [10, 0, 0, "-", "type"], [11, 0, 0, "-", "utils"]], "m3gnet.callbacks": [[3, 1, 1, "", "ManualStop"]], "m3gnet.callbacks.ManualStop": [[3, 2, 1, "", "on_batch_end"]], "m3gnet.cli": [[4, 3, 1, "", "main"], [4, 3, 1, "", "relax_structure"]], "m3gnet.config": [[5, 1, 1, "", "DataType"], [5, 3, 1, "", "set_global_dtypes"]], "m3gnet.config.DataType": [[5, 4, 1, "", "np_float"], [5, 4, 1, "", "np_int"], [5, 2, 1, "", "set_dtype"], [5, 4, 1, "", "tf_float"], [5, 4, 1, "", "tf_int"]], "m3gnet.graph": [[6, 1, 1, "", "BaseGraphConverter"], [6, 1, 1, "", "Index"], [6, 1, 1, "", "MaterialGraph"], [6, 1, 1, "", "MaterialGraphBatch"], [6, 1, 1, "", "MaterialGraphBatchEnergyForceStress"], [6, 1, 1, "", "RadiusCutoffGraphConverter"], [6, 3, 1, "", "assemble_material_graph"], [6, 3, 1, "", "get_fixed_radius_bonding"], [6, 3, 1, "", "get_pair_vector_from_graph"], [6, 3, 1, "", "include_threebody_indices"], [6, 3, 1, "", "tf_compute_distance_angle"]], "m3gnet.graph.BaseGraphConverter": [[6, 2, 1, "", "convert"], [6, 2, 1, "", "convert_many"], [6, 2, 1, "", "get_atom_features"], [6, 2, 1, "", "get_states"], [6, 2, 1, "", "set_default_states"]], "m3gnet.graph.Index": [[6, 4, 1, "", "ATOMS"], [6, 4, 1, "", "ATOM_POSITIONS"], [6, 4, 1, "", "BONDS"], [6, 4, 1, "", "BOND_ATOM_INDICES"], [6, 4, 1, "", "BOND_WEIGHTS"], [6, 4, 1, "", "LATTICES"], [6, 4, 1, "", "N_ATOMS"], [6, 4, 1, "", "N_BONDS"], [6, 4, 1, "", "N_TRIPLE_I"], [6, 4, 1, "", "N_TRIPLE_IJ"], [6, 4, 1, "", "N_TRIPLE_S"], [6, 4, 1, "", "PBC_OFFSETS"], [6, 4, 1, "", "PHI"], [6, 4, 1, "", "STATES"], [6, 4, 1, "", "THETA"], [6, 4, 1, "", "TRIPLE_BOND_INDICES"], [6, 4, 1, "", "TRIPLE_BOND_LENGTHS"]], "m3gnet.graph.MaterialGraph": [[6, 2, 1, "", "as_list"], [6, 2, 1, "", "as_tf"], [6, 4, 1, "", "atom_positions"], [6, 4, 1, "", "atoms"], [6, 4, 1, "", "base_attributes"], [6, 4, 1, "", "bond_atom_indices"], [6, 4, 1, "", "bond_weights"], [6, 4, 1, "", "bonds"], [6, 2, 1, "", "copy"], [6, 2, 1, "", "from_list"], [6, 4, 1, "", "graph_with_position_attributes"], [6, 5, 1, "", "has_threebody"], [6, 4, 1, "", "lattices"], [6, 5, 1, "", "n_atom"], [6, 4, 1, "", "n_atoms"], [6, 5, 1, "", "n_bond"], [6, 4, 1, "", "n_bonds"], [6, 5, 1, "", "n_struct"], [6, 4, 1, "", "n_triple_i"], [6, 4, 1, "", "n_triple_ij"], [6, 4, 1, "", "n_triple_s"], [6, 4, 1, "", "pbc_offsets"], [6, 4, 1, "", "phi"], [6, 4, 1, "", "states"], [6, 4, 1, "", "theta"], [6, 4, 1, "", "three_body_attributes"], [6, 4, 1, "", "triple_bond_indices"], [6, 4, 1, "", "triple_bond_lengths"]], "m3gnet.graph.MaterialGraphBatch": [[6, 2, 1, "", "on_epoch_end"]], "m3gnet.graph.RadiusCutoffGraphConverter": [[6, 2, 1, "", "convert"], [6, 2, 1, "", "get_config"]], "m3gnet.layers": [[7, 1, 1, "", "AtomNetwork"], [7, 1, 1, "", "AtomReduceState"], [7, 1, 1, "", "AtomRef"], [7, 1, 1, "", "BaseAtomRef"], [7, 1, 1, "", "BondNetwork"], [7, 1, 1, "", "ConcatAtoms"], [7, 1, 1, "", "ConcatBondAtomState"], [7, 1, 1, "", "Embedding"], [7, 1, 1, "", "GatedAtomUpdate"], [7, 1, 1, "", "GatedMLP"], [7, 1, 1, "", "GraphFeaturizer"], [7, 1, 1, "", "GraphFieldEmbedding"], [7, 1, 1, "", "GraphNetworkLayer"], [7, 1, 1, "", "GraphUpdate"], [7, 1, 1, "", "GraphUpdateFunc"], [7, 1, 1, "", "MLP"], [7, 1, 1, "", "MultiFieldReadout"], [7, 1, 1, "", "PairDistance"], [7, 1, 1, "", "PairRadialBasisExpansion"], [7, 1, 1, "", "PairVector"], [7, 1, 1, "", "Pipe"], [7, 1, 1, "", "RadialBasisFunctions"], [7, 1, 1, "", "ReadOut"], [7, 1, 1, "", "ReduceReadOut"], [7, 1, 1, "", "Set2Set"], [7, 1, 1, "", "SphericalBesselWithHarmonics"], [7, 1, 1, "", "StateNetwork"], [7, 1, 1, "", "ThreeDInteraction"], [7, 1, 1, "", "WeightedReadout"], [7, 3, 1, "", "cosine"], [7, 3, 1, "", "polynomial"]], "m3gnet.layers.AtomNetwork": [[7, 2, 1, "", "call"], [7, 2, 1, "", "update_atoms"]], "m3gnet.layers.AtomReduceState": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.AtomRef": [[7, 2, 1, "", "call"], [7, 2, 1, "", "fit"], [7, 2, 1, "", "get_config"], [7, 2, 1, "", "inverse_transform"], [7, 2, 1, "", "predict_properties"], [7, 2, 1, "", "set_property_per_element"], [7, 2, 1, "", "transform"]], "m3gnet.layers.BaseAtomRef": [[7, 2, 1, "", "call"]], "m3gnet.layers.BondNetwork": [[7, 2, 1, "", "call"], [7, 2, 1, "", "update_bonds"]], "m3gnet.layers.ConcatAtoms": [[7, 2, 1, "", "get_config"], [7, 2, 1, "", "update_bonds"]], "m3gnet.layers.ConcatBondAtomState": [[7, 2, 1, "", "get_config"], [7, 2, 1, "", "update_states"]], "m3gnet.layers.Embedding": [[7, 2, 1, "", "call"]], "m3gnet.layers.GatedAtomUpdate": [[7, 2, 1, "", "get_config"], [7, 2, 1, "", "update_atoms"]], "m3gnet.layers.GatedMLP": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.GraphFeaturizer": [[7, 2, 1, "", "get_config"]], "m3gnet.layers.GraphFieldEmbedding": [[7, 2, 1, "", "get_config"]], "m3gnet.layers.GraphNetworkLayer": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.GraphUpdate": [[7, 2, 1, "", "call"]], "m3gnet.layers.GraphUpdateFunc": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.MLP": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.MultiFieldReadout": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.PairDistance": [[7, 2, 1, "", "call"]], "m3gnet.layers.PairRadialBasisExpansion": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"], [7, 2, 1, "", "update_bonds"]], "m3gnet.layers.PairVector": [[7, 2, 1, "", "call"]], "m3gnet.layers.Pipe": [[7, 2, 1, "", "call"], [7, 2, 1, "", "from_config"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.RadialBasisFunctions": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.ReadOut": [[7, 2, 1, "", "call"]], "m3gnet.layers.ReduceReadOut": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.Set2Set": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.SphericalBesselWithHarmonics": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.StateNetwork": [[7, 2, 1, "", "call"], [7, 2, 1, "", "update_states"]], "m3gnet.layers.ThreeDInteraction": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.layers.WeightedReadout": [[7, 2, 1, "", "call"], [7, 2, 1, "", "get_config"]], "m3gnet.models": [[8, 1, 1, "", "BasePotential"], [8, 1, 1, "", "GraphModelMixin"], [8, 1, 1, "", "M3GNet"], [8, 1, 1, "", "M3GNetCalculator"], [8, 1, 1, "", "MolecularDynamics"], [8, 1, 1, "", "Potential"], [8, 1, 1, "", "Relaxer"]], "m3gnet.models.BasePotential": [[8, 2, 1, "", "call"], [8, 2, 1, "", "get_ef"], [8, 2, 1, "", "get_ef_tensor"], [8, 2, 1, "", "get_efs"], [8, 2, 1, "", "get_efs_tensor"], [8, 2, 1, "", "get_energies"], [8, 2, 1, "", "get_forces"], [8, 2, 1, "", "get_stresses"]], "m3gnet.models.GraphModelMixin": [[8, 2, 1, "", "predict_graph"], [8, 2, 1, "", "predict_graphs"], [8, 2, 1, "", "predict_structure"], [8, 2, 1, "", "predict_structures"]], "m3gnet.models.M3GNet": [[8, 2, 1, "", "call"], [8, 2, 1, "", "from_config"], [8, 2, 1, "", "from_dir"], [8, 2, 1, "", "get_config"], [8, 2, 1, "", "load"], [8, 2, 1, "", "save"], [8, 2, 1, "", "set_element_refs"]], "m3gnet.models.M3GNetCalculator": [[8, 2, 1, "", "calculate"], [8, 4, 1, "", "implemented_properties"]], "m3gnet.models.MolecularDynamics": [[8, 2, 1, "", "run"], [8, 2, 1, "", "set_atoms"]], "m3gnet.models.Potential": [[8, 2, 1, "", "get_energies"]], "m3gnet.models.Relaxer": [[8, 2, 1, "", "relax"]], "m3gnet.trainers": [[9, 1, 1, "", "PotentialTrainer"], [9, 1, 1, "", "Trainer"]], "m3gnet.trainers.PotentialTrainer": [[9, 2, 1, "", "train"]], "m3gnet.trainers.Trainer": [[9, 2, 1, "", "restart_from_directory"], [9, 2, 1, "", "train"]], "m3gnet.utils": [[11, 1, 1, "", "Gaussian"], [11, 1, 1, "", "SphericalBesselFunction"], [11, 1, 1, "", "SphericalHarmonicsFunction"], [11, 3, 1, "", "broadcast_states_to_atoms"], [11, 3, 1, "", "broadcast_states_to_bonds"], [11, 3, 1, "", "check_array_equal"], [11, 3, 1, "", "check_shape_consistency"], [11, 3, 1, "", "combine_sbf_shf"], [11, 3, 1, "", "get_length"], [11, 3, 1, "", "get_range_indices_from_n"], [11, 3, 1, "", "get_segment_indices_from_n"], [11, 3, 1, "", "get_spherical_bessel_roots"], [11, 3, 1, "", "register"], [11, 3, 1, "", "register_plain"], [11, 3, 1, "", "repeat_with_n"], [11, 3, 1, "", "reshape_array"], [11, 3, 1, "", "spherical_bessel_roots"], [11, 3, 1, "", "spherical_bessel_smooth"], [11, 3, 1, "", "unsorted_segment_fraction"], [11, 3, 1, "", "unsorted_segment_softmax"]], "m3gnet.utils.SphericalBesselFunction": [[11, 2, 1, "", "rbf_j0"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"]}, "titleterms": {"changelog": 0, "v0": 0, "0": 0, "7": 0, "6": 0, "4": 0, "2": 0, "1": 0, "m3gnet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "tabl": 1, "content": [1, 2, 6, 7, 8, 9, 11], "system": 1, "requir": 1, "instal": 1, "appl": 1, "silicon": 1, "chang": 1, "log": 1, "usag": 1, "structur": 1, "relax": 1, "cli": [1, 4], "tool": 1, "molecular": 1, "dynam": 1, "model": [1, 8], "train": 1, "mattervers": 1, "api": 1, "doc": 1, "dataset": 1, "refer": 1, "acknowledg": 1, "packag": [2, 6, 7, 8, 9, 11], "subpackag": 2, "submodul": 2, "modul": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "callback": 3, "config": 5, "graph": 6, "layer": 7, "trainer": 9, "type": 10, "util": [11, 12], "constant": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})